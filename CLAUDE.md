# Gridge Project Manager

グリッジ株式会社（岡山のWeb制作・デジタルマーケティング会社）の案件管理ツール。
Vite + React で構築。現在は単一ファイル（src/App.jsx）のフロントエンドのみ。

## 技術スタック
- React (Hooks: useState, useRef, useCallback, useMemo, useEffect)
- Tailwind CSS v4 (Viteプラグイン)
- CSS変数によるデザイントークン管理
- Supabase（データベース）
- GitHub Actions（自動バックアップ）

## CSS設計
- `src/index.css` にデザイントークンとコンポーネントクラスを定義
- デザイントークン（CSS変数）：
  - `--color-*`: 色（primary, success, warning, danger, text, bg, border）
  - `--font-size-*`: フォントサイズ（xs:10px, sm:11px, base:12px, md:13px, lg:14px）
  - `--spacing-*`: 余白（xs:4px, sm:8px, md:12px, lg:16px, xl:20px）
  - `--radius-*`: 角丸（sm:4px, md:6px, lg:8px, xl:20px, full:9999px）
- コンポーネントクラス: `.btn`, `.chip`, `.input`, `.avatar`, `.task-bar` 等
- 既存のインラインスタイル（STオブジェクト）は段階的に移行中

## 既存機能
- ガントチャート（ドラッグ&ドロップで日程調整、リサイズ、今日線表示）
- メンバービュー（担当者別グルーピング）
- カレンダービュー（日・週・月切替、無限スクロール）
- カンバンビュー（ステータス別・プロジェクト別）
- リストビュー（テーブル表示）
- スムーズズーム（Ctrl+スクロール、スライダー、プリセットボタン）
- 複数選択（クリック、Shift/Ctrl+クリック、案件名クリック）
- マーキー選択（空白ドラッグで範囲選択）
- 一括ドラッグ移動
- タスク詳細パネル（ダブルクリックで開く、編集・完了・コメント機能）
- チームキャパシティ表示
- フィルター（担当者・状態）
- メンバー管理（社内・社外）

## チームメンバー
- 清水 (shimizu) - 営業・全体統括 / 40h/週
- 今重 (imashige) - コンテンツ・企画 / 40h/週
- 藤井 (fujii) - デザイン・撮影 / 40h/週
- 西谷 (nishitani) - エンジニアリング / 40h/週
- 本田 (honda) - ディレクター(パート) / 20h/週

## フェーズ
営業→キックオフ→ワイヤー→ライティング→デザイン→撮影→コーディング→テスト→納品→確認→広告運用

## コーディング規約
- スタイルオブジェクトは `ST` という変数名（`S` は環境で衝突する）
- 小数は必ず `0.5` のように書く（`.5` だと `?.` と誤認される）
- JSXフラグメントは `<React.Fragment>` を使う（`<>` ショートハンドは避ける）
- 新規スタイルはできるだけCSSクラス（index.css）で定義し、CSS変数を活用する
- 日付比較時は時刻を正規化する（開始: 00:00:00、終了: 23:59:59、ループ: 12:00:00）

## 重要なuseMemo/関数
- `headerRows` - ヘッダー行（日/週/月の列）を生成
- `headerCapacities` - 週/月ヘッダーの稼働バー計算
- `memberWorkloads` - メンバー別の週ごとワークロード計算（ガント稼働表示用）
- `rowList` - サイドバー・ガントの行リスト生成
- `TaskPanel` - タスク詳細パネルコンポーネント（ファイル内で定義）

## 開発コマンド
- `npm run dev` - 開発サーバー起動
- `npm run build` - ビルド
- `npx vercel --prod` - Vercelへ本番デプロイ

## デプロイ
- **Vercel** を使用（`npx vercel --prod`）
- GitHubにプッシュ後、手動でデプロイが必要
- 本番URL: https://gridge-pm.vercel.app

## ワークロード計算ルール
- デフォルト: 土日はカウントしない（平日のみ）
- タスクごとに「土日も工数としてカウント」オプションあり
- 祝日: 常にカウントする（キャパシティは減らさない）
- 週のキャパシティ: 祝日があっても40h/週のまま（生産性目標を下げない方針）
- 見積もり工数未入力時: バー日数 × 8h で自動計算

## 日本の祝日
- 2025-2027年の祝日データを `JP_HOLIDAYS` オブジェクトで管理
- ガントチャートで薄い赤背景、ヘッダーで赤色表示
- ホバーで祝日名をツールチップ表示

## 最近の更新（2026-02-14）
- ガントビューにメンバー稼働一覧を追加（📊稼働ボタンで表示切替）
- ワークロード表示を固定高さ（5人分）で独立スクロール可能に
- 日本の祝日表示を追加
- タスクごとの「土日カウント」オプション追加
- ワークロード計算の日付比較バグ修正（金曜日がカウントされない問題）
- 検索機能（コピー可能なフォーマット）
- タスク作成日・更新日の表示
